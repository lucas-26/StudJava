CREATE VIEW VW_PRIMEIRA_VIEW_MAIORES_EMBALAGENS AS 
select EMBALAGEM, MAX(PRECO_DE_LISTA) AS MAIOR_PRECO FROM tabela_de_produtos
group by EMBALAGEM

SELECT X.EMBALAGEM, x.MAIOR_PRECO from VW_PRIMEIRA_VIEW_MAIORES_EMBALAGENS X where x.MAIOR_PRECO >= 10;

SELECT A.NOME_DO_PRODUTO, A.EMBALAGEM, A.PRECO_DE_LISTA, X.MAIOR_PRECO,
(a.PRECO_DE_LISTA / x.MAIOR_PRECO) * 100 AS PERCENTUAL
FROM tabela_de_produtos A INNER JOIN VIEW VW_PRIMEIRA_VIEW_MAIORES_EMBALAGENS X
ON A.EMBALAGEM = X.EMBALAGEM